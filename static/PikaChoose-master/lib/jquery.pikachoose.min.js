(function(b){"use strict";var c={autoPlay:true,speed:5000,text:{play:"",stop:"",previous:"Previous",next:"Next",loading:"Loading"},transition:[1],showCaption:true,IESafe:false,showTooltips:false,carousel:false,carouselVertical:false,animationFinished:null,buildFinished:null,bindsFinished:null,startOn:0,thumbOpacity:0.4,hoverPause:false,animationSpeed:600,fadeThumbsIn:false,carouselOptions:{},thumbChangeEvent:"click.pikachoose",stopOnClick:false,hideThumbnails:false};b.fn.PikaChoose=function(d){return this.each(function(){b(this).data("pikachoose",new a(this,d))})};b.PikaChoose=function(h,i){this.options=b.extend({},c,i||{});this.list=null;this.image=null;this.anchor=null;this.caption=null;this.imgNav=null;this.imgPlay=null;this.imgPrev=null;this.imgNext=null;this.textNext=null;this.textPrev=null;this.previous=null;this.next=null;this.aniWrap=null;this.aniDiv=null;this.aniImg=null;this.thumbs=null;this.transition=null;this.active=null;this.tooltip=null;this.animating=false;this.stillOut=null;this.counter=null;this.timeOut=null;this.pikaStage=null;if(typeof(this.options.data)!="undefined"){h=b("<ul></ul>").addClass("jcarousel-skin-pika").appendTo(h);b.each(this.options.data,function(){var e=null;if(typeof(this.link)!="undefined"){e=b("<li><a href='"+this.link+"'><img></a></li>").appendTo(h);if(typeof(this.title)!="undefined"){e.find("a").attr("title",this.title)}}else{e=b("<li><img></li>").appendTo(h)}if(typeof(this.caption)!="undefined"){e.append("<span>"+this.caption+"</span>")}if(typeof(this.thumbnail)!="undefined"){e.find("img").attr("ref",this.image);e.find("img").attr("src",this.thumbnail)}else{e.find("img").attr("src",this.image)}})}if(h instanceof jQuery||h.nodeName.toUpperCase()=="UL"||h.nodeName.toUpperCase()=="OL"){this.list=b(h);this.build();this.bindEvents()}else{return}var j=0;var d=0;for(var g=0;g<25;g++){var f='<div col="'+j+'" row="'+d+'"></div>';this.aniDiv.append(f);j++;if(j==5){d++;j=0}}};var a=b.PikaChoose;a.fn=a.prototype={version:"74"};b.fn.pikachoose=b.fn.PikaChoose;a.fn.extend=a.extend=b.extend;a.fn.extend({build:function(){this.step=0;if(this.options.pikaStage){this.wrap=this.options.pikaStage;this.wrap.addClass("pika-stage")}else{this.wrap=b("<div class='pika-stage'></div>").insertBefore(this.list)}this.image=b("<img>").appendTo(this.wrap);this.imgNav=b("<div class='pika-imgnav'></div>").insertAfter(this.image);this.imgPlay=b("<a></a>").appendTo(this.imgNav);this.counter=b("<span class='pika-counter'></span>").appendTo(this.imgNav);if(this.options.autoPlay){this.imgPlay.addClass("pause")}else{this.imgPlay.addClass("play")}this.imgPrev=b("<a class='previous'></a>").insertAfter(this.imgPlay);this.imgNext=b("<a class='next'></a>").insertAfter(this.imgPrev);this.caption=b("<div class='caption'></div>").insertAfter(this.imgNav).hide();this.tooltip=b("<div class='pika-tooltip'></div>").insertAfter(this.list).hide();this.aniWrap=b("<div class='pika-aniwrap'></div>").insertAfter(this.caption);this.aniImg=b("<img>").appendTo(this.aniWrap).hide();this.aniDiv=b("<div class='pika-ani'></div>").appendTo(this.aniWrap);this.textNav=b("<div class='pika-textnav'></div>").insertAfter(this.aniWrap);this.textPrev=b("<a class='previous'>"+this.options.text.previous+"</a>").appendTo(this.textNav);this.textNext=b("<a class='next'>"+this.options.text.next+"</a>").appendTo(this.textNav);this.list.addClass("pika-thumbs");this.thumbs=this.list.find("img");this.loader=b("<div class='pika-loader'></div>").appendTo(this.wrap).hide().html(this.options.text.loading);this.active=this.thumbs.eq(this.options.startOn);this.finishAnimating({index:this.options.startOn,source:this.active.attr("ref")||this.active.attr("src"),caption:this.active.parents("li:first").find("span:first").html(),clickThrough:this.active.parent().attr("href")||"",clickThroughTarget:this.active.parent().attr("target")||"",clickThroughTitle:this.active.parent().attr("title")||""});this.aniDiv.css({position:"relative"});var e=this;this.updateThumbs();if(this.options.fadeThumbsIn){this.list.fadeIn()}if(this.options.hideThumbnails){this.list.hide()}if(this.options.carousel){var d={vertical:this.options.carouselVertical,initCallback:function(g){jQuery(g.list).find("img").click(function(k,h){if(typeof(h)!=="undefined"&&h.how=="auto"){if(e.options.autoPlay===false){return false}}var i=parseInt(jQuery(this).parents(".jcarousel-item").attr("jcarouselindex"),10);var j=(jQuery(this).parents("ul").find("li:last").attr("jcarouselindex")==i-1)?true:false;if(!j){i=(i-2<=0)?0:i-2}i++;g.scroll(i)})}};var f=b.extend({},d,this.options.carouselOptions||{});this.list.jcarousel(f)}if(typeof(this.options.buildFinished)=="function"){this.options.buildFinished(this)}},createThumb:function(g){var d=g;var e=this;this.thumbs=this.list.find("img");if(typeof b.data(g[0],"source")!=="undefined"){return}g.parents("li:first").wrapInner("<div class='clip' />");d.hide();b.data(g[0],"clickThrough",d.parent("a").attr("href")||"");b.data(g[0],"clickThroughTarget",d.parent("a").attr("target")||"");b.data(g[0],"clickThroughTitle",d.parent("a").attr("title")||"");if(d.parent("a").length>0){d.unwrap()}b.data(g[0],"caption",d.next("span").html()||"");d.next("span").remove();b.data(g[0],"source",d.attr("ref")||d.attr("src"));b.data(g[0],"imageTitle",d.attr("title")||"");b.data(g[0],"imageAlt",d.attr("alt")||"");b.data(g[0],"index",this.thumbs.index(g));b.data(g[0],"order",d.closest("ul").find("li").index(d.parents("li")));var f=b.data(g[0]);b("<img />").on("load",{data:f},function(){if(typeof(e.options.buildThumbStart)=="function"){e.options.buildThumbStart(e)}var k=b(this);var i=this.width;var n=this.height;if(i===0){i=k.attr("width")}if(n===0){n=k.attr("height")}var p=parseInt(d.parents(".clip").css("height").slice(0,-2),10);var m=parseInt(d.parents(".clip").css("width").slice(0,-2),10);if(m===0){m=d.parents("li:first").outerWidth()}if(p===0){p=d.parents("li:first").outerHeight()}var o=m/i;var j=p/n;var l;if(o<j){d.css({height:"100%"})}else{d.css({width:"100%"})}d.hover(function(h){clearTimeout(e.stillOut);b(this).stop(true,true).fadeTo(250,1);if(!e.options.showTooltips){return}e.tooltip.show().stop(true,true).html(f.caption).animate({top:b(this).parent().position().top,left:b(this).parent().position().left,opacity:1},"fast")},function(h){if(!b(this).hasClass("active")){b(this).stop(true,true).fadeTo(250,e.options.thumbOpacity);e.stillOut=setTimeout(e.hideTooltip,700)}});if(f.order==e.options.startOn){d.fadeTo(250,1);d.addClass("active");d.parents("li").eq(0).addClass("active")}else{d.fadeTo(250,e.options.thumbOpacity)}if(typeof(e.options.buildThumbFinish)=="function"){e.options.buildThumbFinish(e)}}).attr("src",d.attr("src"))},bindEvents:function(){this.thumbs.on(this.options.thumbChangeEvent,{self:this},this.imgClick);this.imgNext.on("click.pikachoose",{self:this},this.nextClick);this.textNext.on("click.pikachoose",{self:this},this.nextClick);this.imgPrev.on("click.pikachoose",{self:this},this.prevClick);this.textPrev.on("click.pikachoose",{self:this},this.prevClick);this.imgPlay.unbind("click.pikachoose").on("click.pikachoose",{self:this},this.playClick);this.wrap.unbind("mouseenter.pikachoose").on("mouseenter.pikachoose",{self:this},function(d){d.data.self.imgNav.stop(true,true).fadeTo("slow",1);if(d.data.self.options.hoverPause===true){clearTimeout(d.data.self.timeOut)}});this.wrap.unbind("mouseleave.pikachoose").on("mouseleave.pikachoose",{self:this},function(d){d.data.self.imgNav.stop(true,true).fadeTo("slow",0);if(d.data.self.options.autoPlay&&d.data.self.options.hoverPause){d.data.self.timeOut=setTimeout((function(e){return function(){e.nextClick()}})(d.data.self),d.data.self.options.speed)}});this.tooltip.unbind("mouseenter.pikachoose").on("mouseenter.pikachoose",{self:this},function(d){clearTimeout(d.data.self.stillOut)});this.tooltip.unbind("mouseleave.pikachoose").on("mouseleave.pikachoose",{self:this},function(d){d.data.self.stillOut=setTimeout(d.data.self.hideTooltip,700)});if(typeof(this.options.bindsFinished)=="function"){this.options.bindsFinished(this)}},hideTooltip:function(d){b(".pika-tooltip").animate({opacity:0.01})},imgClick:function(h,d){var f=h.data.self;var g=b.data(this);if(f.animating){return}if(typeof(d)=="undefined"||d.how!="auto"){if(f.options.autoPlay&&f.options.stopOnClick){f.imgPlay.trigger("click")}else{clearTimeout(f.timeOut)}}else{if(!f.options.autoPlay){return false}}if(b(this).attr("src")!==b.data(this).source){f.loader.fadeIn("fast")}f.caption.fadeOut("slow");f.animating=true;f.active.fadeTo(300,f.options.thumbOpacity).removeClass("active");f.active.parents(".active").eq(0).removeClass("active");f.active=b(this);f.active.addClass("active").fadeTo(200,1);f.active.parents("li").eq(0).addClass("active");b("<img />").on("load",{self:f,data:g},function(){f.loader.fadeOut("fast");f.aniDiv.css({height:f.image.height(),width:f.image.width()}).show();f.aniDiv.children("div").css({width:"20%",height:"20%","float":"left"});var e=0;if(f.options.transition[0]==-1){e=Math.floor(Math.random()*7)+1}else{e=f.options.transition[f.step];f.step++;if(f.step>=f.options.transition.length){f.step=0}}if(f.options.IESafe&&b.browser.msie){e=1}f.doAnimation(e,g)}).attr("src",b.data(this).source)},doAnimation:function(i,g){this.aniWrap.css({position:"absolute",top:this.wrap.css("padding-top"),left:this.wrap.css("padding-left"),width:this.wrap.width()});var e=this;e.image.stop(true,false);e.caption.stop().fadeOut();var f=e.aniDiv.children("div").eq(0).width();var h=e.aniDiv.children("div").eq(0).height();var d=new Image();b(d).attr("src",g.source);if(d.height!=e.image.height()||d.width!=e.image.width()){if(i!==0&&i!==1&&i!==7){}}e.aniDiv.css({height:e.image.height(),width:e.image.width()});e.aniDiv.children().each(function(){var l=b(this);var j=Math.floor(l.parent().width()/5)*l.attr("col");var k=Math.floor(l.parent().height()/5)*l.attr("row");l.css({background:"url("+g.source+") -"+j+"px -"+k+"px","background-size":l.parent().width()+"px "+l.parent().height()+"px",width:"0px",height:"0px",position:"absolute",top:k+"px",left:j+"px","float":"none"})});e.aniDiv.hide();e.aniImg.hide();switch(i){case 0:e.image.stop(true,true).fadeOut(e.options.animationSpeed,function(){e.image.attr("src",g.source).fadeIn(e.options.animationSpeed,function(){e.finishAnimating(g)})});break;case 1:e.aniDiv.hide();e.aniImg.height(e.image.height()).hide().attr("src",g.source);e.wrap.css({height:e.image.height()});b.when(e.image.fadeOut(e.options.animationSpeed),e.aniImg.eq(0).fadeIn(e.options.animationSpeed)).done(function(){e.finishAnimating(g)});break;case 2:e.aniDiv.show().children().hide().each(function(k){var j=k*30;b(this).css({opacity:0.1}).show().delay(j).animate({opacity:1,width:f,height:h},200,"linear",function(){if(e.aniDiv.find("div").index(this)==24){e.finishAnimating(g)}})});break;case 3:e.aniDiv.show().children("div:lt(5)").hide().each(function(k){var j=b(this).attr("col")*100;b(this).css({opacity:0.1,width:f}).show().delay(j).animate({opacity:1,height:e.image.height()},e.options.animationSpeed,"linear",function(){if(e.aniDiv.find(" div").index(this)==4){e.finishAnimating(g)}})});break;case 4:e.aniDiv.show().children().hide().each(function(k){if(k>4){return}var j=b(this).attr("col")*30;var m=e.gapper(b(this),h,f);var l=e.options.animationSpeed*0.7;b(this).css({opacity:0.1,height:"100%"}).show().delay(j).animate({opacity:1,width:m.width},l,"linear",function(){if(e.aniDiv.find(" div").index(this)==4){e.finishAnimating(g)}})});break;case 5:e.aniDiv.show().children().show().each(function(k){var j=k*Math.floor(Math.random()*5)*7;var l=e.gapper(b(this),h,f);if(b(".animation div").index(this)==24){j=700}b(this).css({height:l.height,width:l.width,opacity:0.01}).delay(j).animate({opacity:1},e.options.animationSpeed,function(){if(e.aniDiv.find(" div").index(this)==24){e.finishAnimating(g)}})});break;case 6:e.aniDiv.height(e.image.height()).hide().css({background:"url("+g.source+") top left no-repeat"});e.aniDiv.children("div").hide();e.aniDiv.css({width:0}).show().animate({width:e.image.width()},e.options.animationSpeed,function(){e.finishAnimating(g);e.aniDiv.css({background:"transparent"})});break;case 7:e.wrap.css({overflow:"hidden"});e.aniImg.height(e.image.height()).hide().attr("src",g.source);e.aniDiv.hide();e.image.css({position:"relative"}).animate({left:"-"+e.wrap.outerWidth()+"px"});e.aniImg.show();e.aniWrap.css({left:e.wrap.outerWidth()}).show().animate({left:"0px"},e.options.animationSpeed,function(){e.finishAnimating(g)});break}},finishAnimating:function(f){this.animating=false;this.image.attr("src",f.source);this.image.attr("alt",f.imageAlt);this.image.attr("title",f.imageTitle);this.image.css({left:"0"});this.image.show();var d=this;b("<img />").on("load",function(){d.aniImg.fadeOut("fast");d.aniDiv.fadeOut("fast")}).attr("src",f.source);var g=f.index+1;var e=this.thumbs.length;this.counter.html(g+"/"+e);if(f.clickThrough!==""){if(this.anchor===null){this.anchor=this.image.wrap("<a>").parent()}this.anchor.attr("href",f.clickThrough);this.anchor.attr("title",f.clickThroughTitle);this.anchor.attr("target",f.clickThroughTarget)}else{if(this.image.parent("a").length>0){this.image.unwrap()}this.anchor=null}if(this.options.showCaption&&f.caption!==""&&f.caption!==null){this.caption.html(f.caption).fadeTo("slow",1)}if(this.options.autoPlay){this.timeOut=setTimeout((function(h){return function(){h.nextClick()}})(this),this.options.speed,this.timeOut)}if(typeof(this.options.animationFinished)=="function"){this.options.animationFinished(this)}},gapper:function(e,f,d){var g;if(e.attr("row")==4){g=(this.aniDiv.height()-(f*5))+f;f=g}if(e.attr("col")==4){g=(this.aniDiv.width()-(d*5))+d;d=g}return{height:f,width:d}},nextClick:function(i){var g="natural";var d=null;try{d=i.data.self;if(typeof(i.data.self.options.next)=="function"){i.data.self.options.next(this)}}catch(h){d=this;g="auto"}var f=d.active.parents("li:first").next().find("img");if(f.length===0){f=d.list.find("img").eq(0)}f.trigger("click",{how:g});return f},prevClick:function(g){if(typeof(g.data.self.options.previous)=="function"){g.data.self.options.previous(this)}var d=g.data.self;var f=d.active.parents("li:first").prev().find("img");if(f.length===0){f=d.list.find("img:last")}f.trigger("click");return f},playClick:function(f){var d=f.data.self;d.options.autoPlay=!d.options.autoPlay;d.imgPlay.toggleClass("play").toggleClass("pause");if(d.options.autoPlay){d.nextClick()}else{clearTimeout(d.timeOut)}return(d.options.autoPlay)?"playing":"paused"},Next:function(){var d={data:{self:this}};return this.nextClick(d)},Prev:function(){var d={data:{self:this}};return this.prevClick(d)},GoTo:function(d){var g={data:{self:this}};var f=this.list.find("img").eq(d);if(f.length>0){f.trigger("click");return f}else{throw"Image not found. Images are 0 indexed."}},Play:function(){if(this.options.autoPlay){return"playing"}var d={data:{self:this}};return this.playClick(d)},Pause:function(){if(!this.options.autoPlay){return"paused"}var d={data:{self:this}};return this.playClick(d)},updateThumbs:function(){var d=this;this.thumbs=this.list.find("img");this.thumbs.each(function(){d.createThumb(b(this),d)})}})})(jQuery);